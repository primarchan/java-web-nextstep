# 4.HTTP 웹 서버 구현을 통해 HTTP 이해하기

## 4.2 HTTP 웹 서버 구현
- 웹 클라이언트는 웹 서버와 데이터를 주고받기 위해 HTTP라는 서로 간에 약속된 규약을 따름
- 모든 HTTP 요청에 대해 요청 라인, 요청 헤더, 빈 공백 문자열은 필수, 요청 본문은 비필수 요소
> - 웹 클라이언트 -> 웹 서버 요청 예시)  
> `POST /user/create HTTP/1.1` -> 요청 라인  
> `HOST: localhost:8080` -> 요청 헤더  
> `Connection-Length: 59`  -> 요청 헤더  
> `Content-type: application/x-www-form-urlencoded`  -> 요청 헤더  
> `Accept: */*` -> 요청 헤더  
> -> 헤더와 본문 사이의 빈 공백 라인  
> `userId=primarchan&password=1111` -> 요청 본문
>
> 
> - 웹 서버 -> 웹 클라이언트 응답 예시   
> `HTTP/1.1 200 OK` -> 상태 라인  
> `Content-type: text/htlml;charset=utf-8` -> 응답 헤더  
> `Content-Length: 20` -> 응답 헤더  
> -> 헤더와 본문 사이의 빈 공백 라인
> `<h1>응답 본문입니다.<h1>` -> 응답 본문

### 4.2.1.4  
- 이슈: 요구사항 #3 에서 url 을 "index.html" 로 변경 후 새로고침 시 회원가입 요청이 재전송 되는 현상 발생
- 원인: 브라우저가 이전 요청 정보를 유지하고 있음 -> 새로고침 시 유지하고 있는 요청 재전송
- 해결: 회원가입을 처리하는 /user/create 요청과 첫 화면(index.html) 을 보여주는 요청 분리 후 HTTP 의 302 상태코드 활용
- 다음과 같이 응답을 보내도록 구현
> `HTTP/1.1 302 Found`  
> `Location: /index.html`

### 4.2.1.5
- HTTP 는 요청을 보내고 응답을 받으면 클라이언트와 서버 간의 연결을 끊음
- 클라이언트와 서버 간의 연결을 끊기 때문에 각 요청 사이에 상태를 공유할 수 없음 -> HTTP 무상태 프로토콜
- HTTP 로그인과 같이 클라이언트의 행위를 기억하기 위한 목적으로 지원하는 것이 Cookie
- HTTP 가 Cookie 를 지원하는 방법
  - 서버에서 로그인 요청을 받으면 (반대의 경우도 가능) 로그인 성공/실패 여부에 따라 응답 헤더에 Set-Cookie 록 값을 저장
  - 클라이언트는 응답 헤더에 Set-Cookie 가 존재할 경우, Set-Cookie 의 값을 읽어 서버에 보내는 요청 헤더의 Cookie 값으로 다시 전송
  - 즉, HTTP 는 각 요청 간의 데이터를 공유할 방법이 없기 때문에 헤더를 통해 공유할 데이트를 매번 다시 전송하는 방식으로 데이터 공유
